<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Smoke</title>
      <link rel="stylesheet" href="css/style.css" />
   </head>
   <style>
	@font-face {
		font-family: 'Amstirdam';
		src: url('css/SVN-Amstirdam.otf') format('opentype');
		font-weight: normal;
		font-style: normal;
	}

	* {
		margin: 0;
		padding: 0;
		box-sizing: border-box;
		font-family: 'Amstirdam', sans-serif;
	}

	.bg {
		position: relative;
		width: 100%;
		height: 100vh;
		background: url('backgroundV3.png');
		background-size: cover;
		background-position: bottom;
		display: flex;
		justify-content: center;
		align-items: center;
	}

	.bg .main-text {}

	.bg .fog {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		overflow: hidden;
		pointer-events: none;
	}

	.bg .fog .classic-fog {
		position: absolute;
		bottom: 0;
		max-width: 100%;
		animation: fog_effect calc(3s * var(--i)) ease-in infinite;
		transition: bottom 10s;
	}

	@keyframes fog_effect {
		0% {
			opacity: 0;
			transform: scale(1);
		}

		25%,
		75% {
			opacity: 1;
		}

		100% {
			transform: scale(var(--s));
			opacity: 0;
		}
	}

	.opacity-zero {
		bottom: calc(var(--s) * -11vh) !important
	}

	.cover {
		position: absolute;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
		background-color: white;
		opacity: 1;
		transition: all 2s ease-out;
	}

	.main-text {
		position: absolute;
		top: 10%;
		color: #a36d7e;
		z-index: 1;
		font-family: Amstirdam;
		font-size: 200px;
		/* animation setup */
		opacity: 0;
		clip-path: inset(0 100% 0 0);
		animation: reveal 3s ease-out forwards;
	}

	@keyframes reveal {
		from {
			opacity: 0;
			clip-path: inset(0 100% 0 0);
		}

		to {
			opacity: 1;
			clip-path: inset(0 0 0 0);
		}
	}

	.text-container {
		width: 100%;
		display: flex;
		justify-content: center;
	}

	.heart {
		color: #a36d7e;
		opacity: 0;
		/* start hidden */
		z-index: 1;
		font-size: 400px;
		transition: opacity 0.5s ease-in;
		/* smooth fade-in */
		animation: pound 2.5s infinite;
	}

	@keyframes pound {

		0%,
		100% {
			transform: scale(1);
		}

		25% {
			transform: scale(1.2);
		}

		50% {
			transform: scale(1);
		}

		75% {
			transform: scale(1.2);
		}
	}
   </style>
   <script src="https://kit.fontawesome.com/d5c9485222.js" crossorigin="anonymous"></script>
   <body>
      <div class="bg">
         <div class="text-container">
            <h2 id="text" class="main-text">Bấm trái tim dể thấy công chúa</h2>
            <i id="heart" class="heart fa-solid fa-heart"></i>
         </div>
         <div class="cover"></div>
         <div class="fog">
            <img class="classic-fog classic-fog--a" src="images/fog1.png" style="--s: 30;--i: 1;" />
            <img class="classic-fog classic-fog--a" src="images/fog2.png" style="--s: 30;--i: 2;" />
            <img class="classic-fog classic-fog--a" src="images/fog3.png" style="--s: 30;--i: 3;" />
            <img class="classic-fog classic-fog--a" src="images/fog4.png" style="--s: 30;--i: 4;" />
            <img class="classic-fog classic-fog--a" src="images/fog5.png" style="--s: 30;--i: 5;" />
            <img class="classic-fog classic-fog--a" src="images/fog1.png" style="--s: 30;--i: 10;" />
            <img class="classic-fog classic-fog--a" src="images/fog2.png" style="--s: 30;--i: 9;" />
            <img class="classic-fog classic-fog--a" src="images/fog3.png" style="--s: 30;--i: 8;" />
            <img class="classic-fog classic-fog--a" src="images/fog4.png" style="--s: 30;--i: 7;" />
            <img class="classic-fog classic-fog--a" src="images/fog5.png" style="--s: 30;--i: 6;" />
            <img class="classic-fog classic-fog--b" src="images/fog1.png" style="--s: 15;--i: 1;" />
            <img class="classic-fog classic-fog--b" src="images/fog2.png" style="--s: 15;--i: 2;" />
            <img class="classic-fog classic-fog--b" src="images/fog3.png" style="--s: 15;--i: 3;" />
            <img class="classic-fog classic-fog--b" src="images/fog4.png" style="--s: 15;--i: 4;" />
            <img class="classic-fog classic-fog--b" src="images/fog5.png" style="--s: 15;--i: 5;" />
            <img class="classic-fog classic-fog--b" src="images/fog1.png" style="--s: 15;--i: 10;" />
            <img class="classic-fog classic-fog--b" src="images/fog2.png" style="--s: 15;--i: 9;" />
            <img class="classic-fog classic-fog--b" src="images/fog3.png" style="--s: 15;--i: 8;" />
            <img class="classic-fog classic-fog--b" src="images/fog4.png" style="--s: 15;--i: 7;" />
            <img class="classic-fog classic-fog--b" src="images/fog5.png" style="--s: 15;--i: 6;" />
            <img class="classic-fog classic-fog--c" src="images/fog1.png" style="--s: 10;--i: 1;" />
            <img class="classic-fog classic-fog--c" src="images/fog2.png" style="--s: 10;--i: 2;" />
            <img class="classic-fog classic-fog--c" src="images/fog3.png" style="--s: 10;--i: 3;" />
            <img class="classic-fog classic-fog--c" src="images/fog4.png" style="--s: 10;--i: 4;" />
            <img class="classic-fog classic-fog--c" src="images/fog5.png" style="--s: 10;--i: 5;" />
            <img class="classic-fog classic-fog--c" src="images/fog1.png" style="--s: 10;--i: 10;" />
            <img class="classic-fog classic-fog--c" src="images/fog2.png" style="--s: 10;--i: 9;" />
            <img class="classic-fog classic-fog--c" src="images/fog3.png" style="--s: 10;--i: 8;" />
            <img class="classic-fog classic-fog--c" src="images/fog4.png" style="--s: 10;--i: 7;" />
            <img class="classic-fog classic-fog--c" src="images/fog5.png" style="--s: 10;--i: 6;" />
            <img class="classic-fog classic-fog--d" src="images/fog1.png" style="--s: 5;--i: 1;" />
            <img class="classic-fog classic-fog--d" src="images/fog2.png" style="--s: 5;--i: 2;" />
            <img class="classic-fog classic-fog--d" src="images/fog3.png" style="--s: 5;--i: 3;" />
            <img class="classic-fog classic-fog--d" src="images/fog4.png" style="--s: 5;--i: 4;" />
            <img class="classic-fog classic-fog--d" src="images/fog5.png" style="--s: 5;--i: 5;" />
            <img class="classic-fog classic-fog--d" src="images/fog1.png" style="--s: 5;--i: 10;" />
            <img class="classic-fog classic-fog--d" src="images/fog2.png" style="--s: 5;--i: 9;" />
            <img class="classic-fog classic-fog--d" src="images/fog3.png" style="--s: 5;--i: 8;" />
            <img class="classic-fog classic-fog--d" src="images/fog4.png" style="--s: 5;--i: 7;" />
            <img class="classic-fog classic-fog--d" src="images/fog5.png" style="--s: 5;--i: 6;" />
            <img class="classic-fog classic-fog--e" src="images/fog1.png" style="--s: 3;--i: 1;" />
            <img class="classic-fog classic-fog--e" src="images/fog2.png" style="--s: 3;--i: 2;" />
            <img class="classic-fog classic-fog--e" src="images/fog3.png" style="--s: 3;--i: 3;" />
            <img class="classic-fog classic-fog--e" src="images/fog4.png" style="--s: 3;--i: 4;" />
            <img class="classic-fog classic-fog--e" src="images/fog5.png" style="--s: 3;--i: 5;" />
            <img class="classic-fog classic-fog--e" src="images/fog1.png" style="--s: 3;--i: 10;" />
            <img class="classic-fog classic-fog--e" src="images/fog2.png" style="--s: 3;--i: 9;" />
            <img class="classic-fog classic-fog--e" src="images/fog3.png" style="--s: 3;--i: 8;" />
            <img class="classic-fog classic-fog--e" src="images/fog4.png" style="--s: 3;--i: 7;" />
            <img class="classic-fog classic-fog--e" src="images/fog5.png" style="--s: 3;--i: 6;" />
         </div>
      </div>
   </body>
   <script>
      const button = document.getElementById("heart");
      const fogImagesA = document.querySelectorAll(".classic-fog.classic-fog--a");
      const fogImagesB = document.querySelectorAll(".classic-fog.classic-fog--b");
      const fogImagesC = document.querySelectorAll(".classic-fog.classic-fog--c");
      const fogImagesD = document.querySelectorAll(".classic-fog.classic-fog--d");
      const fogImagesE = document.querySelectorAll(".classic-fog.classic-fog--e");
      
      function fadeOut(element) {
      	
      	  // 1. Get current opacity
      	 //const style = window.getComputedStyle(element);
      	 //const currentOpacity = style.opacity;
      
      	  // 2. Stop keyframe animation
      	  //element.style.animationIterationCount  = "1";
      
      	  // 3. Set opacity to current value so transition starts from here
      	  //element.style.opacity = "0 !important";
      	  
      	  element.classList.add("opacity-zero")
      
      	  // 4. Trigger scale reduction and fade
      	 // requestAnimationFrame(() => {
      	//	element.style.opacity = "0 !important";      // Fade out
      	//	//element.style.setProperty("--s", "5"); // Shrink scale
      	 // });
      
      	// Optional: remove element after fade
      	element.addEventListener("animationend", function handler(e) {
      		console.log(element, Date.now())
      		element.classList.add("opacity-zero")
      		element.style.setProperty("--s", "5"); // Shrink scale
      	});
      }
      
      button.addEventListener("click", () => {
      
      	button.style.opacity = 0;
      
      	const groups = [fogImagesA, fogImagesB, fogImagesC, fogImagesD, fogImagesE];
      
      	let groupDelay = 0;
      	groups.forEach(group => {
      	  group.forEach((element, i) => {
      		setTimeout(() => fadeOut(element), groupDelay + 5 * i)
      	  })
      	  groupDelay += 5 * group.length; // start next group after previous finishes
      	})
      
      
      	
      })
      
      
      setTimeout(() => document.querySelector(".cover").style.opacity = 0, 4000)
      const text = document.getElementById("text");
      const heart = document.getElementById("heart");
      
      // Listen for the text animation end
      text.addEventListener("animationend", () => {
         heart.style.opacity = 1; // fade in the heart
      });
      
   </script>
</html>
